{% extends "base.html" %}

{% block nav %}
  <nav>
    <a href="{{url_for('home')}}"><p id="winterest-logo">Winterest</p></a>
    <div id="profile-logout-container">
      <div id="user-circle" class="circle-img">
        <p>{{currentUserInfo.fname[0]}}{{currentUserInfo.lname[0]}}</p>
      </div>
      <form method=post action="{{url_for('logout')}}">
        <button class="gray-button" id="logout-button" type="submit" name="logout" value="logout">Logout</button>
      </form>
    </div>
    </a>
  </nav>
{% endblock %}

{% block main_content %}
<div class="main-content">
<section class="match-section">
  <h1 class="section-header">Find Friends</h1>
  <div class="match-photo">
    <div class="one-match active" value="{{person.wemail}}">
      <!-- Will update once we learn about file upload -->
      {% if photo %}
      <img id="match-image-cropped" src="{{url_for('pic', wemail=person.wemail)}}" alt="">
      {% else %}
      <img id="match-image-cropped" src="{{url_for('static', filename='nophoto.jpg')}}" alt="">
      {% endif %}
      <!-- <img id="match-image" src="{{url_for('static', filename = 'person.jpg')}}" alt=""> -->
      <div class="match-header">
        <h2 class="match-name">{{person.fname}}</h2>
        <p class="match-subheader">Class of {{person.year}}</p>
        <div id="more-profile">
          <p class="profile-bio">
            {{matchBio.bio}}
          </p>
          <div class="profile-interests" data-state="closed">
            {% if person.favorites %}
              {% for favorite in person.favorites %}
              <div class="interest-box">
                <div class="interest-emoji">{{emojis[favorite.itemType]}}</div>
                <p>My favorite {{favorite.itemType}} is <strong>{{favorite.name}}</strong></p>
              </div>
              {% endfor %}
            {% else %}
              <div class="interest-box">
                <div class="interest-emoji">‚ùì</div>
                <p>Ask me for my interests!</strong></p>
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    <form class="button-form" method=post action="{{url_for('back')}}">
      <button class="button-form-element" type="submit" name="submit" value="{{person.wemail}}">
        <div id="left-button" class="circle left-arrow">
          <img src="{{url_for('static', filename = 'arrow.png')}}" alt="">
        </div>
      </button>
    </form>
    <form class="button-form" method=post action="{{url_for('next')}}">
      <button class="button-form-element" type="submit" name="submit" value="{{person.wemail}}">
        <div id="right-button" class="circle right-arrow">
          <img src="{{url_for('static', filename = 'arrow.png')}}" alt="">
        </div>
      </button>
    </form>
    <div class="match-buttons">
      <button class="blue-button" id="more-info-button" type="submit" name="submit" value="info">üëÄ More Information</button>
      {% if matchStatus %}
              <!-- not yet implemented -->

      <form id="match-button-form" method=post action="">
        <button id="match-button" type="submit" name="submit" value="{{person.wemail}}">üíî Unmatch</button>
      </form>
      {% else %}
        <form id="match-button-form" method=post action="{{url_for('makeMatch')}}">
          <button id="match-button" type="submit" name="submit" value="{{person.wemail}}">üíñ Match</button>
        </form>
      {% endif %}
      <button class="gray-button" id="shuffle-button" type="submit" name="submit" value="shuffle">üîÄ Shuffle</button>
    </div>
</section>
<section id="current-matches">
  <h1 class="section-header">Current Matches</h1>
  {% for match in currentMatches %}
  <a class="match-link" href="{{url_for('match', wemail=match.wemail)}}">
    <div class="match-containers">
      <div class="circle-img">
        <p>{{match.fname[0]}}{{match.lname[0]}}</p>
      </div>
      <div class="matches-info">
        <h3>{{match.fname}}</h3>
        <p class="match-subheader">Class of {{match.year}}</p>
      </div>
    </div>
  </a>
  {% endfor %}

  {% if matches|length <= 4 %}
  <div class="more-container">
    <div class="matches-info">
      <h3>much empty.</h3>
      <p class="match-subheader">get matching!</p>
    </div>
  </div>
  {% endif %}

</section>
</div>
{% endblock %}


{% block end_scripts %}
<script>
   /* Expands and collapses section for "More Information" */
   $("#more-info-button").on("click", function(event) {
    console.log("click")
    $button = $("#more-info-button");
    $profile = $("#more-profile");
    if ($profile.css("display") == 'none') {
      $profile.css("display", "block");
      $button.text("‚úåÔ∏è Less Information");
    }
    else {
      $profile.css("display", "none");
      $button.text("üëÄ More Information");
    }
});

  /* Toggles between match and unmatch */
  $matchButton = $("#match-button");
  $matchButton.on("click", function(event) {
      value = $matchButton.attr('value');
      if (value == 'match') {
        // Do some match thingy
        $button.text("üíî Unmatch");
      }
      else {
        $button.text("‚ù§Ô∏è Match");
      }
    });
    
    // carosel = 0;
    // matchSlides = $(".one-match")
    // length = matchSlides.length

    // $("#left-button").on("click", function(event) {
    //   $(matchSlides[carosel]).removeClass('active')
    //   if (carosel == 0) { carosel = length-1; }
    //   else { carosel -= 1;  }
    //   $(matchSlides[carosel]).addClass('active')
    //   console.log(carosel)
    // });

    // $("#right-button").on("click", function(event) {
    //   $(matchSlides[carosel]).removeClass('active')
    //   if (carosel == length-1) { carosel = 0; }
    //   else { carosel += 1;  }
    //   $(matchSlides[carosel]).addClass('active')
    //   console.log(carosel)
    // });
  </script>
{% endblock %}
